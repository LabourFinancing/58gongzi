<!DOCTYPE html>
<!-- [if IE 8]> <html lang="en" class="ie8 no-js"> <![endif] -->
<!-- [if IE 9]> <html lang="en" class="ie9 no-js"> <![endif] -->
<!-- [if !IE]><! -->
<!-- <html lang="en"> -->
<!-- <![endif] -->
<!-- BEGIN HEAD -->

<head>
<meta charset="utf-8">
<title>我发工资 | 登录</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta content="width=device-width, initial-scale=1" name="viewport">
<meta content="" name="description">
<meta content="" name="author">
<meta http-equiv="Cache-Control" content="no-store">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<!-- BEGIN GLOBAL MANDATORY STYLES -->
<#include "/common/commonContext.html">
<link rel="icon" href="${ctx}/metronic/global/img/58gongzi-3.png" type="image/x-icon" />
<link rel="shortcut icon" href="${ctx}/metronic/global/img/58gongzi-3.png" type="image/x-icon" />
<script src="${ctx}/metronic/global/plugins/loading.js" type="text/javascript"></script>
<!-- BEGIN GLOBAL MANDATORY STYLES -->
<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300,600,700&amp;subset=all" rel="stylesheet"
type="text/css">
<link href="${ctx}/metronic/mobile/css/font-awesome.min.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="${ctx}/metronic/mobile/css/simple-line-icons.min.css">
<link rel="stylesheet" href="${ctx}/metronic/mobile/css/bootstrap.min.css">
<link rel="stylesheet" href="${ctx}/metronic/mobile/css/uniform.default.css">
<link rel="stylesheet" href="${ctx}/metronic/mobile/css/bootstrap-switch.min.css">
<!-- END GLOBAL MANDATORY STYLES -->

<!-- BEGIN THEME GLOBAL STYLES -->
<link rel="stylesheet" href="${ctx}/metronic/mobile/css/components.min.css" id="style_components" type="text/css">
<link rel="stylesheet" href="${ctx}/metronic/mobile/css/plugins.min.css">
<!-- END THEME GLOBAL STYLES -->

<!-- BEGIN THEME LAYOUT STYLES -->
<link rel="stylesheet" href="${ctx}/metronic/mobile/css/layout.min.css">
<link rel="stylesheet" href="${ctx}/metronic/mobile/css/light.min.css">
<link rel="stylesheet" href="${ctx}/metronic/mobile/css/custom.min.css">
<!-- END THEME LAYOUT STYLES -->

<!-- <link href="/metronic/global/plugins/bootstrap-datepicker/css/bootstrap-datepicker3.min.css" rel="stylesheet" type="text/css"> -->

<link rel="stylesheet" href="${ctx}/metronic/mobile/css/copybootrstap.css">
<!-- <link href="/plugins/layer/skin/layer.css" rel="stylesheet" type="text/css"> -->
<link rel="stylesheet" href="${ctx}/metronic/mobile/layer/skin/layer.css">
<link rel="stylesheet" href="${ctx}/metronic/mobile/user/login.css">
<!-- mask -->

<style>
/* 分页组件输入框的样式，保证高度的统一 */
.pagination .controls input {
border: 0;
color: #999;
width: 30px;
padding: 0;
text-align: center;
}
</style>

<!-- <link rel="shortcut icon" href="favicon.ico">BEGIN PAGE LEVEL STYLES -->
<!-- <link href="/metronic/pages/css/login.min.css" rel="stylesheet" type="text/css"> -->
<!-- END PAGE LEVEL STYLES -->
<!--[if lt IE 9]>
<script src="/metronic/global/plugins/respond.min.js"></script>
<script src="/metronic/global/plugins/excanvas.min.js"></script> 
<![endif] -->
<!-- BEGIN CORE PLUGINS -->
<script src="${ctx}/metronic/global/plugins/jsbridge-mini.js" type="text/javascript"></script>
<script src="${ctx}/metronic/mobile/js/jquery-2.1.3.js" type="text/javascript"></script>
<script src="${ctx}/metronic/mobile/js/jsbridge-mini.js" type="text/javascript"></script>
<script src="${ctx}/metronic/mobile/js/bootstrap.min.js" type="text/javascript"></script>
<script src="${ctx}/metronic/mobile/js/js.cookie.min.js" type="text/javascript"></script>
<script src="${ctx}/metronic/mobile/js/bootstrap-hover-dropdown.min.js" type="text/javascript"></script>
<script src="${ctx}/metronic/mobile/js/jquery.slimscroll.min.js" type="text/javascript"></script>
<script src="${ctx}/metronic/mobile/js/jquery.blockui.min.js" type="text/javascript"></script>
<script src="${ctx}/metronic/mobile/js/jquery.uniform.min.js" type="text/javascript"></script>
<script src="${ctx}/metronic/mobile/js/bootstrap-switch.min.js" type="text/javascript"></script>
<script src="${ctx}/metronic/mobile/js/js.cookie.min.js" type="text/javascript"></script>
<!-- <script src="/metronic/global/plugins/bootstrap/js/bootstrap.min.js" type="text/javascript"></script> -->

<!-- <script src="/metronic/global/plugins/js.cookie.min.js" type="text/javascript"></script>
<script src="/metronic/global/plugins/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js" type="text/javascript"></script>
<script src="/metronic/global/plugins/jquery-slimscroll/jquery.slimscroll.min.js" type="text/javascript"></script>
<script src="/metronic/global/plugins/jquery.blockui.min.js" type="text/javascript"></script>
<script src="/metronic/global/plugins/uniform/jquery.uniform.min.js" type="text/javascript"></script>
<script src="/metronic/global/plugins/bootstrap-switch/js/bootstrap-switch.min.js" type="text/javascript"></script> -->
<!-- END CORE PLUGINS -->

<!-- BEGIN COMMON PAGE LEVEL PLUGINS -->
<script src="${ctx}/metronic/mobile/js/jquery.validate.min.js" type="text/javascript"></script>
<script src="${ctx}/metronic/mobile/js/additional-methods.min.js" type="text/javascript"></script>
<script src="${ctx}/metronic/mobile/js/messages_zh.min.js" type="text/javascript"></script>
<!-- <script src="/metronic/global/plugins/jquery-validation/js/jquery.validate.min.js" type="text/javascript"></script>
<script src="/metronic/global/plugins/jquery-validation/js/additional-methods.min.js" type="text/javascript"></script>
<script src="/metronic/global/plugins/jquery-validation/js/localization/messages_zh.min.js" type="text/javascript"></script> -->
<!-- END COMMON PAGE LEVEL PLUGINS -->

<!-- BEGIN THEME GLOBAL SCRIPTS -->
<script src="${ctx}/metronic/mobile/js/app.min.js" type="text/javascript"></script>
<!-- <script src="/metronic/global/scripts/app.min.js" type="text/javascript"></script> -->
<!-- END THEME GLOBAL SCRIPTS -->

<!-- BEGIN THEME LAYOUT SCRIPTS -->
<script src="${ctx}/metronic/mobile/js/layouts.js" type="text/javascript"></script>
<!-- <script src="/metronic/layouts/layout4/scripts/layout.min.js" type="text/javascript"></script> -->
<!-- <script src="/metronic/layouts/layout4/scripts/demo.min.js" type="text/javascript"></script> -->
<!-- <script src="/metronic/layouts/global/scripts/quick-sidebar.min.js" type="text/javascript"></script> -->
<!-- END THEME LAYOUT SCRIPTS -->

<!-- <script src="/metronic/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.min.js" type="text/javascript"></script> -->
<script src="${ctx}/metronic/mobile/js/components-date-time-picker.min.js" type="text/javascript"></script>
<!-- jQuery mask -->
<script src="${ctx}/metronic/mobile/layer/layer.js"></script>
<!-- jQuery new added -->
<script src="${ctx}/metronic/mobile/js/card.js" type="text/javascript"></script>

<!-- END mask -->

<!--[if lt IE 10]>
    <meta http-equiv="Refresh" content="0; url=/browserNotMatch" />
    <![endif]-->

<style type="text/css">
        .error-color {
            font-weight: bold;
            color: #f50000
        }

        input::-webkit-input-placeholder {
            color: #999;
            -webkit-transition: color.5s;
        }

        input:focus::-webkit-input-placeholder,
        input:hover::-webkit-input-placeholder {
            color: #c2c2c2;
            -webkit-transition: color.5s;
        }

        dot {
            display: inline-block;
            height: 1em;
            line-height: 1;
            text-align: left;
            vertical-align: -.25em;
            overflow: hidden;
        }
        dot::before {
            display: block;
            content: '...\A..\A.';
            white-space: pre-wrap;   /* 也可以是white-space: pre */
            animation: dot 1s infinite step-start both;
        }
        @keyframes dot {
            33% { transform: translateY(-2em); }
            66% { transform: translateY(-1em); }
        }
</style>
    <script type="text/javascript">
        jsBridge.clearCache();
        jsBridge.clearCookie();
    </script>
<script type="text/javascript">
    var user_name = $("#userName").val();
    
        window.onload = function ()//用window的onload事件，窗体加载完毕的时候
        {
            //single login
            var href = location.href;
            if (href.indexOf("kickout") > 0) {
                alert("您的账号在另一台设备上登录,如非本人操作，请立即修改密码！");
            }

            var gid = getQueryVar("gid", "");
            if (gid === 'lianfeng') {
                document.all.logo_login.src = "${ctx}/metronic/pages/img/lianfen_logo.png";
                document.getElementById("ServiceInfo").style.display = "none";
            }
            else if
                (gid.length === 64) {
                $.ajax({
                    url: "/index?gid=" + gid,
                    type: 'POST',
                    async: true,
                    cache: false,
                    contentType: false,
                    processData: false,
                    success: function (data) {
                        var result = eval("(" + data + ")");
                        console.info(data);
                        if (result.ret == "-1") {
                            $("#msg").html("<font color='#f50000' style='font-weight:bold;'>" + result.msg + "</font>")
                        } else if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent) && result.host == "M") {
                            window.location.href = "${ctx}/StaffPrepayApplicationController/staffPrepayApplicationNew";
                            mobileview = true;
                        } else {
                            window.location.href = "${request.getContextPath()}/mainFrame";
                            mobileview = false;
                        }
                    },
                    error: function (data) {
                        var result = eval("(" + data + ")");
                        alert(result.msg);
                    },
                });
            }
            ;
        }
        $(document).ready(
            function () {
                var form = $('#loginForm');
                form.validate({
                    errorElement: 'span', //default input error message container
                    errorClass: 'error-color', // default input error message class
                    focusInvalid: false, // do not focus the last invalid input
                    rules: {
                        userName: {
                            required: true
                        },
                        password: {
                            required: true
                        }
                    },
                    messages: {
                        userName: {
                            required: "<font color='#f50000' style='font-weight:bold;'>请填入用户名</font>"
                        },
                        password: {
                            required: "<font color='#f50000' style='font-weight:bold;'>请填入密码</font>"
                        }
                    },

                    invalidHandler: function (event, validator) { //display error alert on form submit              
                        App.scrollTo(form, 0);
                    },

                    highlight: function (element) { // hightlight error inputs
                        $(element).closest('.form-group').removeClass(
                            "has-success").addClass('has-error'); // set error class to the control group   
                    },

                    unhighlight: function (element) { // revert the change done by hightlight

                    },

                    success: function (label, element) {
                        var icon = $(element).parent('.input-icon').children(
                            'i');
                        $(element).closest('.form-group').removeClass(
                            'has-error').addClass('has-success'); // set success class to the control group
                        icon.removeClass("fa-warning").addClass("fa-check");
                    },

                    submitHandler: function (form) {
                        var formData = new FormData($('#loginForm')[0]);
                        document.getElementById("LoginLoading").style.display = "";
                        $.ajax({
                            url: "${ctx}/oauthController/login?type=login",
                            type: 'POST',
                            data: formData,
                            async: true,
                            cache: false,
                            contentType: false,
                            processData: false,
                            success: function (data) {
                                var result = eval("(" + data + ")");
                                if (result.ret == "-1") {
                                    $("#msg").html("<font color='#f50000' style='font-weight:bold;'>" + result.msg + "</font>");
                                    console.log('-----------fail---------', data);
                                    document.getElementById("LoginLoading").style.display = "none";
                                } else if (/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent) && result.host == "M") {
                                    console.info("***************mobile****************",data);
                                    window.location.href = "${ctx}/StaffPrepayApplicationController/staffPrepayApplicationNew";
                                } else {
                                    window.location.href = "${request.getContextPath()}/mainFrame";
                                }
                            },
                            error: function (data, b,c) {
                            	console.log('---------error-----------', data,b,c)
                                var result = eval("(" + data + ")");
                                document.getElementById("LoginLoading").style.display = "none";
                                alert(result.msg);
                            },
                        });
                    }
                });

                $('.login-form input').keypress(function (e) {
                    if (e.which == 13) {
                        if ($('.login-form').validate().form()) {
                            $('.login-form').submit(); //form validation success, call ajax form submit
                        }
                        return false;
                    }
                });
            });

        function openReset() {
            if (document.getElementById("userName").value == null) {
                alert("请输入用户名")
            } else {
                $.ajax({
                    type: 'POST',
                    url: "${ctx}/oauthController/login?type=resendPWD" + "&userName=" + $("#userName").val(),
                    async: true,
                    cache: false,
                    contentType: false,
                    processData: false,
                    success: function (data) {
                        var result = eval("(" + data + ")");
                        alert(result.msg);
                    },
                    error: function (data) {
                        alert("用户不存在,请重新输入")
                    }
                });
            }
            return;
        }
        function getQueryVar(name, defVal) {
            var re = new RegExp('.*[?&]' + name + '=([^&#]*)');
            var match = document.location.href.match(re);
            if (typeof defVal === 'undefined') {
                defVal = null;
            }
            if (match) {
                return decodeURIComponent(match[1]);
            }
            return defVal;
        }
</script>

</head>
<!-- END HEAD -->

<body>
<div class=" login">
    <div class="menu-toggler sidebar-toggler"></div>
    <!-- END SIDEBAR TOGGLER BUTTON -->
    <!-- BEGIN LOGO -->
    <div class="logo">
        <a href="index.html"> <img id="logo_login" src="${ctx}/metronic/mobile/imgs/login-banner.png" alt="">
        </a>
    </div>
    <!-- END LOGO -->
    <!-- BEGIN LOGIN -->
    <div class="content">
        <!-- BEGIN LOGIN FORM -->
        <form id="loginForm" class="login-form" method="post" novalidate="novalidate">
            <h3 class="form-title">登录</h3>
            <div class="alert alert-danger display-hide">
                <button class="close" data-close="alert"></button>
                <span> 请输入用户名和密码. </span>
            </div>
            <div class="form-group">
                <!--ie8, ie9 does not support html5 placeholder, so we just show field title for that-->
                <label class="control-label visible-ie8 visible-ie9"><img id="l-img1" class="lable-img l-img1"
                            src="${ctx}/metronic/mobile/imgs/user-name.png" alt=""></label> <input
                        class="form-control form-control-solid placeholder-no-fix" type="text" autocomplete="off"
                        placeholder="输入你的用户名/手机号" id="userName" name="userName">
            </div>
            <div class="form-group">
                <label class="control-label visible-ie8 visible-ie9"><img id="l-img2" class="lable-img l-img2"
                            src="${ctx}/metronic/mobile/imgs/pwd.png" alt=""></label><input
                        class="form-control form-control-solid placeholder-no-fix" type="password" autocomplete="off"
                        placeholder="输入您的密码" id="password" name="password">
                           <!--默认闭眼图-->
            </div>
            <div class="form-group"><input class="form-control form-control-solid placeholder-no-fix" type="hidden"
                        autocomplete="off" id="platform" name="platform">
            </div>

            <div id="msg"></div>
            <div class="form-actions">
                <button type="submit" class="btn green uppercase togomaincon">登录<span id="LoginLoading" style="display:none">中<dot>...</dot></span></button>
                <a type="button" class="bgu" name="PWresend" id="PWresend" onclick="openReset()">找回密码</a>
            </div>
        </form>
        <!-- END LOGIN FORM -->
        <!-- BEGIN FORGOT PASSWORD FORM -->
        <form class="forget-form" action="index.html" method="post">
            <h3 class="font-green">Forget Password ?</h3>
            <p>Enter your e-mail address below to reset your password.</p>
            <div class="form-actions">
                <button type="button" id="back-btn" class="btn btn-default">Back</button>
                <button type="submit" class="btn btn-success uppercase pull-right">Submit</button>
            </div>
        </form>
        <!-- END FORGOT PASSWORD FORM -->
    </div>
    <div class="copyright">QQ客服：161909537 <br> QQ客服：2368200770</div>
	<div class="copyright" id="copyrighticp" name="copyrighticp">Copyright © 2020高孚信科 <a href="http://www.miitbeian.gov.cn/">沪ICP备20023417号-1</a> 
	<div id="copyrightsec" name="copyrightsec" style="width:300px;margin:0 auto; padding:20px 0;">
		 <a target="_blank" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=35062202000124" style="display:inline-block;text-decoration:none;height:20px;line-height:20px;"><img src="${ctx}/metronic/pages/img/ghs.png" style="float:left;"/><p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#939393;">沪公网安备 35062202000124号</p></a>
	</div>
</div>
<script src="${ctx}/metronic/mobile/user/changestyle.js" type="text/javascript"></script>
<script type="text/javascript">
		$(function () {
			mobileview();
		    indexstyle();
		    eyectl();
		    //适配
		    var client_width = document.documentElement.clientWidth
		    if (client_width == 320) {
		        $('.content').addClass("width300")
		        $('.logo').addClass("logo_s")
		    } else {
		        $(".content").removeClass("width300")
		        $('.logo').removeClass("logo_s")
		    }
		})
        function indexstyle() {
            //console.log(domwhos1)
            indexStyle({
                bodyColor: "#EDF3F9",//body背景色
                loginColor: "#1490FF", //登录头部背景色
                logoSrc: "${ctx}/metronic/mobile/imgs/login-banner.png", //logo图片地址
                formTitleColor: "#3E4A59", //表单标题字体颜色
                loginBtnBg: "linear-gradient(to right, #1490FF 0%,#007AE8 100%)", //登录按钮背景色
                loginBtnCl: "#fff", //按钮字体颜色
                copyRightCl: "#242424", //QQ客服字体颜色
                iconUserImg: "${ctx}/metronic/mobile/imgs/user-name.png", //用户图标
                iconPWImg: "${ctx}/metronic/mobile/imgs/pwd.png", //密码图标
            });
        }

		function mobileview() {
			   var userAgentInfo = navigator.userAgent;
			   var mobileview = true;
			   var Agents = ["Android", "iPhone",
			      "SymbianOS", "Windows Phone",
			      "iPad", "iPod"];
				document.getElementById("copyrighticp").style.visibility = "visible";
				document.getElementById("copyrightsec").style.visibility = "visible";
			   var mobileview = true;
			   for (var v = 0; v < Agents.length; v++) {
			      if (userAgentInfo.indexOf(Agents[v]) > 0) {
			    mobileview = false;
				document.getElementById("copyrighticp").style.visibility = "hidden";
			    document.getElementById("copyrightsec").style.visibility = "hidden";
			         break;
			      }
			   }
			   return mobileview;
			}
		
		function eyectl() {
		      //获取元素（两种方式都可以）
		    var input = document.getElementById('password')
		    var imgs = document.getElementById('l-img2');
		    //下面是一个判断每次点击的效果
		    var flag = 0;
		    imgs.onclick = function () {
		      if (flag == 0) {
		        input.type = 'text';
		        imgs.src = '${ctx}/metronic/mobile/imgs/pwdopen.png';//睁眼图
		        flag = 1;
		      } else {
		        input.type = 'password';
		        imgs.src = '${ctx}/metronic/mobile/imgs/pwd.png';//闭眼图
		        flag = 0;
		      }
		    }
		}
    
</script>
</body>

</html>